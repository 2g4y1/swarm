#!/bin/bash
############################################################################################################################################################
############################################################################################################################################################
# DO NOT EDIT THE LINES BELOW !!! DO NOT EDIT THE LINES BELOW !!! DO NOT EDIT THE LINES BELOW !!! DO NOT EDIT THE LINES BELOW !!!
############################################################################################################################################################
############################################################################################################################################################

version=0.1.1

############################################################################################################################################################

source /var/lib/swarm/modules/variables

############################################################################################################################################################

# Run module sudo check
source $modules/sudoers

# Remove old HLM version if exist
source $modules/hlmremover

# Run module alias check
source $modules/aliases

# Run PACKAGE module
source $modules/packages

# Run VERSION module
source $modules/versions

# Run GO module check
source $modules/gochecker

# Run module restart check
source $modules/hostrestart

# Start main script
counter=0
while [ $counter -lt 1 ]; do
    clear
    source $configs/hornet.cfg
    source $configs/nginx.cfg
    source $configs/swarm.cfg

    # Check if SWARM log exist
    if [ ! -f "$swarmlog" ]; then
        source $modules/logcheck
    else
        source $swarmlog
    fi

    # Run module plugin status check
    source $modules/pluginstatus

    ############################################################################################################################################################

    CHOICE=$(
        whiptail --title "Welcome to SWARM! [v$version]" --menu "\nChoose an option:" 16 65 0 \
        "1)" "SWARM Info" \
        "2)" "Hornet Menu" \
        "3)" "Proxy Menu" \
        "4)" "SWARM Menu" 3>&2 2>&1 1>&3
    )
    exitstatus=$?
    if [ "$exitstatus" = "1" ]; then
        clear
        exit 0
    fi

    case $CHOICE in
        "1)")
            # SWARM INFO
            source $modules/swarminfo
        ;;
        "2)")
            # HORNET MENU
            source $modules/hornetmenu
        ;;
        "3)")
            # PROXY MENU
            source $modules/proxymenu
        ;;
        "4)")
            # SWARM Menu
            source $modules/swarmmenu
        ;;
    esac
done

############################################################################################################################################################

counter=0
clear
exit 0
