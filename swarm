#!/bin/bash
############################################################################################################################################################
############################################################################################################################################################
# DO NOT EDIT THE LINES BELOW !!! DO NOT EDIT THE LINES BELOW !!! DO NOT EDIT THE LINES BELOW !!! DO NOT EDIT THE LINES BELOW !!!
############################################################################################################################################################
############################################################################################################################################################

version=0.4.0

############################################################################################################################################################

source /var/lib/swarm/modules/variables

############################################################################################################################################################

# Run updateParser
source $modules/updater/updateParser

# Load Theme
source $modules/themes

# Run module sudo check
source $modules/chkReq

# Run VERSION module
source $modules/getVersions

# Run PACKAGE module
source $modules/packages

# Run module restart check
source $modules/hostRestart

commit=$( cd $swarmDir ; git rev-parse --short HEAD )
version="$version-$commit"

# Start main script
counter=0
while [ $counter -lt 1 ]; do
    clear
    source $configs/hornet.cfg
    source $configs/proxy.cfg
    source $configs/swarm.cfg

    # Load logs
    source $logs/watchdog
    source $logs/dbPruner

    ############################################################################################################################################################

    if [ "${node,,}" = "hornet" ]; then
        CHOICE=$(
            whiptail --title "Welcome to SWARM! [v$version]" --menu "\nChoose an option:" 16 65 0 \
            "1)" "SWARM Info" \
            "2)" "Hornet Menu" \
            "3)" "Proxy Menu" \
            "4)" "SWARM Menu" 3>&2 2>&1 1>&3
        )
        exitStatus=$?
        if [ "$exitStatus" = "1" ]; then
            clear
            exit 0
        fi

        case $CHOICE in
            "1)")
                # SWARM INFO
                source $modules/swarmInfo
            ;;
            "2)")
                # HORNET MENU
                source $modules/hornet/hornetMenu
            ;;
            "3)")
                # PROXY MENU
                source $modules/proxy/proxyMenu
            ;;
            "4)")
                # SWARM Menu
                source $modules/swarmMenu
            ;;
        esac
    fi
done

############################################################################################################################################################

counter=0
clear
exit 0
