#!/bin/bash
############################################################################################################################################################
############################################################################################################################################################
# DO NOT EDIT THE LINES BELOW !!! DO NOT EDIT THE LINES BELOW !!! DO NOT EDIT THE LINES BELOW !!! DO NOT EDIT THE LINES BELOW !!!
############################################################################################################################################################
############################################################################################################################################################

version=0.2.0

############################################################################################################################################################

source /var/lib/swarm/modules/variables

############################################################################################################################################################

# Run module sudo check
source $modules/sudoers

# Load Theme
source $modules/themes

# Remove old HLM version if exist
source $modules/hlmremover

# Run VERSION module
source $modules/getversions

# Run module swarm update
source $modules/swarmupdate

# Run module alias check
source $modules/aliases

# Run PACKAGE module
source $modules/packages

# Run GO module check
source $modules/gochecker

# Run module restart check
source $modules/hostrestart

if [ -d "$swarmdir/log" ]; then
    sudo rm -rf $swarmdir/log
fi

# Start main script
counter=0
while [ $counter -lt 1 ]; do
    clear
    source $configs/hornet.cfg
    source $configs/proxy.cfg
    source $configs/swarm.cfg
    source $configs/goshimmer.cfg

    # Load logs
    source $logs/swarm
    source $logs/watchdog
    source $logs/dbpruner

    # Check empty vars
    source $modules/checkvars

    # Run module plugin status check
    #source $modules/pluginstatus

    ############################################################################################################################################################

    CHOICE=$(
        whiptail --title "Welcome to SWARM! [v$version]" --menu "\nChoose an option:" 16 65 0 \
        "1)" "SWARM Info" \
        "2)" "Hornet Menu" \
        "3)" "GoShimmer Menu" \
        "4)" "Proxy Menu" \
        "5)" "SWARM Menu" 3>&2 2>&1 1>&3
    )
    exitstatus=$?
    if [ "$exitstatus" = "1" ]; then
        clear
        exit 0
    fi

    case $CHOICE in
        "1)")
            # SWARM INFO
            source $modules/menu/swarminfo
        ;;
        "2)")
            # HORNET MENU
            source $modules/menu/hornetmenu
        ;;
        "3)")
            # HORNET MENU
            source $modules/menu/goshimmermenu
        ;;
        "4)")
            # PROXY MENU
            source $modules/menu/proxymenu
        ;;
        "5)")
            # SWARM Menu
            source $modules/menu/swarmmenu
        ;;
    esac
done

############################################################################################################################################################

counter=0
clear
exit 0
