#!/bin/bash
source $swarmConfigs/proxy.cfg

if [ -f "/usr/sbin/nginx" ]; then
    proxyStatus=$(systemctl show -p ActiveState --value nginx)
    hr="\n\n#############################################################"

    if [ ! -z "$proxyHornetDomain" ] && [ ! -z "$proxyHornetPort" ] && [ -d "/etc/letsencrypt/live/$proxyHornetDomain" ]; then
        proxyHornetUrl="\n\nHornet (Dashboard/API)\nhttps://$proxyHornetDomain:$proxyHornetPort"
    fi
    if [ ! -z "$proxyBeeDomain" ] && [ ! -z "$proxyBeePort" ] && [ -d "/etc/letsencrypt/live/$proxyBeeDomain" ]; then
        proxyBeeUrl="\n\nBee (Dashboard/API)\nhttps://$proxyBeeDomain:$proxyBeePort"
    fi
    if [ ! -z "$proxyGoshimmerDomain" ] && [ ! -z "$proxyGoshimmerPort" ] && [ -d "/etc/letsencrypt/live/$proxyGoshimmerDomain" ]; then
        proxyGoshimmerUrl="\n\nGoShimmer (Dashboard/API)\nhttps://$proxyGoshimmerDomain:$proxyGoshimmerPort"
    fi
    if [ ! -z "$proxyWaspDashboardDomain" ] && [ ! -z "$proxyWaspDashboardPort" ] && [ -d "/etc/letsencrypt/live/$proxyWaspDashboardDomain" ]; then
        proxyWaspDashboardUrl="\n\nWASP (Dashboard)\nhttps://$proxyWaspDashboardDomain:$proxyWaspDashboardPort"
    fi
    if [ ! -z "$proxyWaspApiDomain" ] && [ ! -z "$proxyWaspApiPort" ] && [ -d "/etc/letsencrypt/live/$proxyWaspApiDomain" ]; then
        proxyWaspApiUrl="\n\nWASP (API)\nhttps://$proxyWaspApiDomain:$proxyWaspApiPort"
    fi

    # OUTPUT
    whiptail --title "Proxy Info [v$version]" --msgbox "Webserver: ${proxyStatus}${hr}${proxyHornetUrl}${proxyBeeUrl}${proxyGoshimmerUrl}${proxyWaspDashboardUrl}${proxyWaspApiUrl}" 27 65
else
    whiptail --title "Proxy Info [v$version]" --msgbox "Reverse proxy not installed!" 8 65
fi