#!/bin/bash

if [ -d "/etc/nginx" ]; then
    if [ ! -f "$configs/.api_htpasswd" ]; then
        sudo touch $configs/.api_htpasswd
    fi
else
    whiptail --title "Proxy Menu" --msgbox "Please deploy the reverse proxy first!" 8 65
fi

deleteUsername=$(whiptail --inputbox "Please enter the user to be deleted:" 8 65 --title "Proxy Menu" 3>&1 1>&2 2>&3)
if [ ! -z $deleteUsername ]; then
    delUserApi=$(htpasswd -D $configs/.api_htpasswd $deleteUsername 2>&1)
    whiptail --title "Proxy Menu" --msgbox "$delUserApi" 8 65
    sudo systemctl reload nginx
else
    whiptail --title "Proxy Menu" --msgbox "Incorrect input, please enter username!" 8 65
fi