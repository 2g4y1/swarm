#!/bin/bash

# Bee version
if [ -f "/usr/bin/bee" ]; then
    beeVersion=$(curl -s -X GET "http://localhost:14266/api/v1/info" -H  "accept: application/json"|jq '.data.version' | tr -d 'v"' | cut -f1 -d"-")
    beeVersionNumber=$(echo $beeVersion | tr -d '.')
    beeVersionZeroCheck=${$beeVersionNumber:0:1}
    if [ "$beeVersionZeroCheck" = "0" ]; then
        beeVersionNumber=${beeVersionNumber:1}
    fi
fi

# Latest Bee version
latestBeeVersion=$(curl -s -X GET "https://cdn.tanglebay.com/github/version" -H  "accept: application/json"|jq -r '.data.node.bee.stable' 2> /dev/null | tr -d '"')

# Replace var if empty
if [ -z "$latestBeeVersion" ] || [ "$latestBeeVersion" = "null" ]; then
    latestBeeVersion=$beeVersion
fi

if [ -z "$beeVersion" ]; then
    beeVersion=$latestBeeVersion
fi
