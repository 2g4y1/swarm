#!/bin/bash

parserBefore=$(sed -n '/\[autopeering\]/,/entry_nodes/p' $beeHome/config.chrysalis-$beeNetwork.toml)
sed -i '/\[autopeering\]/,/entry_nodes/{//!d}' $beeHome/config.chrysalis-$beeNetwork.toml
sed -i 's~\[autopeering\]~\[autopeering\]\nenabled = '$beeAutopeeringEnabled'\nbind_address = "0.0.0.0:'$beeAutopeeringPort'"~g' $beeHome/config.chrysalis-$beeNetwork.toml
parserAfter=$(sed -n '/\[autopeering\]/,/entry_nodes/p' $beeHome/config.chrysalis-$beeNetwork.toml)

if [ "$parserBefore" != "$parserAfter" ]; then
    restartBee=true
fi

unset parserBefore
unset parserAfter