#!/bin/bash

if (whiptail --title "SWARM Menu" --yesno --defaultno "Are you sure you want to delete SWARM and all packages?" 8 65); then
    {
        echo 0
        sudo systemctl stop nginx > /dev/null 2>&1
        sudo systemctl disable nginx > /dev/null 2>&1
        echo 10
        sudo systemctl stop hornet > /dev/null 2>&1
        sudo systemctl disable hornet > /dev/null 2>&1
        echo 50
        sudo apt -qq purge whois -y > /dev/null 2>&1
        echo 30
        sudo apt -qq purge sponge -y > /dev/null 2>&1
        echo 40
        sudo apt -qq purge software-properties-common certbot python3-certbot-nginx -y > /dev/null 2>&1
        echo 50
        sudo apt -qq purge hornet -y > /dev/null 2>&1
        echo 60
        sudo rm -rf /etc/apt/sources.list.d/hornet.list
        echo 70
        sleep 0.25
        sudo rm -rf /etc/nginx
        echo 80
        sleep 0.25
        ( crontab -l | grep -v -F "$croncmd" ) | crontab -
        echo 90
        sleep 0.25
        ( crontab -l | grep -v -F "$dbpcroncmd" ) | crontab -
        echo 95
        sleep 0.25
        sudo rm -rf /var/lib/swarm
        echo 100
        sleep 0.25
    } | whiptail --gauge "Please wait while SWARM will be removed from your system..." 6 65 0
    whiptail --title "SWARM Menu" --msgbox "Removing SWARM successfully. Thanks for using SWARM!" 8 65
    clear
    exit 0
fi