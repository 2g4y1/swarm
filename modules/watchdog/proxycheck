#!/bin/bash

if [ "$proxycheck" = "true" ]; then
    checkproxy="$(curl -sL -w "%{http_code}\n" "https://$domain:$nodeport/status" -o /dev/null)"
    if [ "$checkproxy" = "500" ] || [ "$checkproxy" = "502" ] ; then
        restartdt=`date '+%d-%m-%Y %H-%M-%S'`
        sudo systemctl restart nginx
        echo "$restartdt WACHTDOG - PROXYCHECK - Proxy restarted while ERROR detected!" >> $logs/swarm.log
    fi
fi