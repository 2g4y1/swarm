#!/bin/bash

parser="$(jq '.autopeering.seed' $goshimmerDir/config.json)"
if [ -z "$goshimmerSeed" ]; then
    if [ -z "$parser" ]; then
        goshimmerSeed=$(openssl rand -base64 32)
        goshimmerSeed="base64:$goshimmerSeed"
        sudo sed -i 's~^goshimmerSeed=.*~goshimmerSeed="'$goshimmerSeed'"~g' $configs/goshimmer.cfg
    else
        goshimmerSeed=$parser
        sudo sed -i 's~^goshimmerSeed=.*~goshimmerSeed="'$goshimmerSeed'"~g' $configs/goshimmer.cfg
    fi
else
    if [ "$parser" != "\"$goshimmerSeed\"" ]; then
        sudo jq '.autopeering.seed = "'$goshimmerSeed'"' $goshimmerDir/config.json|sponge $goshimmerDir/config.json
        restartGoshimmer=true
    fi
fi
